---
import BaseLayout from './BaseLayout.astro';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import PersonSchema from '../components/schemas/PersonSchema.astro';

export interface Props {
  title: string;
  description: string;
  date: string;
  dateModified?: string;
  canonical: string;
  ogImage?: string;
  keywords?: string[];
  category?: string;
  tags?: string[];
  readingTime?: string;
  relatedLinks?: Array<{ title: string; url: string; type?: string }>;
}

const {
  title,
  description,
  date,
  dateModified,
  canonical,
  ogImage,
  keywords = [],
  category,
  tags = [],
  readingTime,
  relatedLinks = [],
} = Astro.props;

// Auto-generate related links based on URL structure
const urlPath = new URL(canonical).pathname;
const autoRelatedLinks: Array<{ title: string; url: string; type: string }> = [];

// Add parent hub link (with trailing slashes)
let parentHub: { title: string; url: string } | null = null;

if (urlPath.includes('/ai-security/jailbreaking/')) {
  parentHub = { title: 'AI Security: Jailbreaking', url: '/ai-security/jailbreaking/' };
  autoRelatedLinks.push(
    { title: 'AI Security: Jailbreaking', url: '/ai-security/jailbreaking/', type: 'Hub' },
    { title: 'AATMF Framework', url: '/frameworks/aatmf/', type: 'Framework' }
  );
} else if (urlPath.includes('/ai-security/prompt-injection/')) {
  parentHub = { title: 'AI Security: Prompt Injection', url: '/ai-security/prompt-injection/' };
  autoRelatedLinks.push(
    { title: 'AI Security: Prompt Injection', url: '/ai-security/prompt-injection/', type: 'Hub' },
    { title: 'AATMF Framework', url: '/frameworks/aatmf/', type: 'Framework' }
  );
} else if (urlPath.includes('/ai-security/')) {
  parentHub = { title: 'AI Security Research', url: '/ai-security/' };
  autoRelatedLinks.push(
    { title: 'AI Security Research', url: '/ai-security/', type: 'Hub' },
    { title: 'AATMF Framework', url: '/frameworks/aatmf/', type: 'Framework' }
  );
} else if (urlPath.includes('/security-research/cves/')) {
  parentHub = { title: 'CVE Disclosures', url: '/security-research/cves/' };
  autoRelatedLinks.push(
    { title: 'CVE Disclosures', url: '/security-research/cves/', type: 'Hub' },
    { title: 'Security Research', url: '/security-research/', type: 'Research' }
  );
} else if (urlPath.includes('/security-research/general/')) {
  parentHub = { title: 'Security Research', url: '/security-research/' };
  autoRelatedLinks.push(
    { title: 'Security Research', url: '/security-research/', type: 'Hub' },
    { title: 'CVE Disclosures', url: '/security-research/cves/', type: 'Research' }
  );
} else if (urlPath.includes('/writing/')) {
  parentHub = { title: 'Writing', url: '/writing/' };
  autoRelatedLinks.push(
    { title: 'All Writing', url: '/writing/', type: 'Hub' },
    { title: 'About Kai Aizen', url: '/about/', type: 'Author' }
  );
} else if (urlPath.includes('/frameworks/')) {
  parentHub = { title: 'Security Frameworks', url: '/frameworks/' };
  autoRelatedLinks.push(
    { title: 'Security Frameworks', url: '/frameworks/', type: 'Hub' },
    { title: 'AATMF Framework', url: '/frameworks/aatmf/', type: 'Framework' }
  );
}

// Combine auto-generated and manually provided links
const allRelatedLinks = [...autoRelatedLinks, ...relatedLinks].slice(0, 4);

// Generate breadcrumb from URL
const pathSegments = new URL(canonical).pathname.split('/').filter(Boolean);
const breadcrumbs = [
  { name: 'Home', url: 'https://snailsploit.com' }
];

// Special case mappings for proper casing
const segmentNameMap: Record<string, string> = {
  'ai-security': 'AI Security',
  'cves': 'CVEs',
  'edr-evasion-techniques': 'EDR Evasion Techniques',
  'mcp-threat-analysis': 'MCP Threat Analysis',
  'mcp-security-deep-dive': 'MCP Security Deep Dive',
  'rag-agentic-attack-surface': 'RAG & Agentic Attack Surface',
};

let currentPath = '';
pathSegments.forEach((segment, index) => {
  currentPath += `/${segment}`;
  if (index < pathSegments.length - 1) {
    const name = segmentNameMap[segment] || segment.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
    breadcrumbs.push({ name, url: `https://snailsploit.com${currentPath}` });
  }
});

// TechArticle schema - more appropriate for technical security content
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": title,
  "description": description,
  "author": {
    "@type": "Person",
    "@id": "https://snailsploit.com/#person",
    "name": "Kai Aizen",
    "url": "https://snailsploit.com/about/",
    "sameAs": [
      "https://linkedin.com/in/kaiaizen",
      "https://github.com/SnailSploit"
    ]
  },
  "datePublished": new Date(date).toISOString(),
  "dateModified": dateModified ? new Date(dateModified).toISOString() : new Date(date).toISOString(),
  "mainEntityOfPage": canonical,
  "publisher": {
    "@type": "Organization",
    "name": "SnailSploit",
    "url": "https://snailsploit.com"
  },
  "proficiencyLevel": "Expert",
  "keywords": keywords.join(', ')
};

// Breadcrumb schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": breadcrumbs.map((crumb, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "name": crumb.name,
    ...(index < breadcrumbs.length - 1 && { "item": crumb.url })
  }))
};

const formattedDate = new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<BaseLayout
  title={title}
  description={description}
  canonical={canonical}
  ogType="article"
  ogImage={ogImage || '/images/og-article.png'}
  keywords={keywords}
  schemaData={[articleSchema, breadcrumbSchema]}
  publishedDate={new Date(date).toISOString()}
  modifiedDate={dateModified ? new Date(dateModified).toISOString() : undefined}
>
  <Navigation slot="header" />
  <PersonSchema />

  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Breadcrumbs -->
    <nav class="mb-8 text-sm font-mono" style="color: var(--color-text-muted);">
      {breadcrumbs.map((crumb, index) => (
        <span>
          {index < breadcrumbs.length - 1 ? (
            <a href={crumb.url} class="hover:text-[var(--color-accent-red)] transition-colors">
              {crumb.name}
            </a>
          ) : (
            <span>{title}</span>
          )}
          {index < breadcrumbs.length - 1 && <span class="mx-2">/</span>}
        </span>
      ))}
    </nav>

    <!-- Article Header -->
    <header class="article-header mb-16 relative">
      <!-- Decorative background glow -->
      <div class="title-glow"></div>

      <h1 class="article-title">
        <span class="title-text">{title}</span>
      </h1>

      <div class="article-meta">
        <time datetime={new Date(date).toISOString()} class="meta-item">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          {formattedDate}
        </time>
        {readingTime && (
          <span class="meta-item">
            <span class="meta-dot"></span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {readingTime}
          </span>
        )}
        {category && (
          <span class="meta-item">
            <span class="meta-dot"></span>
            <span class="category-badge">{category}</span>
          </span>
        )}
      </div>

      {tags.length > 0 && (
        <div class="tag-container">
          {tags.map(tag => (
            <span class="tag-pill">
              {tag}
            </span>
          ))}
        </div>
      )}

      {/* Part of Hub Link */}
      {parentHub && (
        <div class="hub-link">
          <span class="hub-label">Part of</span>
          <a href={parentHub.url} class="hub-anchor">
            {parentHub.title}
            <svg class="w-4 h-4 inline-block ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
            </svg>
          </a>
        </div>
      )}

      <!-- Decorative divider -->
      <div class="header-divider"></div>
    </header>

    <!-- Article Content -->
    <div class="prose prose-invert prose-lg max-w-none">
      <slot />
    </div>

    <!-- Author Bio -->
    <div class="author-card mt-16 p-8 rounded-2xl relative overflow-hidden" style="background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(15, 15, 15, 0.98)); border: 1px solid rgba(220, 38, 38, 0.2);">
      <div class="absolute top-0 left-0 w-full h-1" style="background: linear-gradient(90deg, var(--color-accent-red), transparent);"></div>

      <div class="flex items-start gap-6">
        <div class="w-16 h-16 rounded-full flex-shrink-0 flex items-center justify-center" style="background: linear-gradient(135deg, rgba(220, 38, 38, 0.2), rgba(220, 38, 38, 0.05)); border: 2px solid rgba(220, 38, 38, 0.3);">
          <span style="font-family: 'Plus Jakarta Sans', sans-serif; font-size: 1.5rem; font-weight: 700; color: var(--color-accent-red);">KA</span>
        </div>

        <div class="flex-1">
          <h3 style="font-family: 'Plus Jakarta Sans', sans-serif; font-size: 1.25rem; font-weight: 700; color: #ffffff; margin-bottom: 0.25rem;">
            Kai Aizen
          </h3>
          <p style="font-family: 'Inter', sans-serif; font-size: 0.875rem; color: var(--color-accent-red); margin-bottom: 1rem;">
            Security Researcher & 6x CVE Holder
          </p>
          <p style="font-family: 'Source Serif 4', Georgia, serif; font-size: 1rem; color: #a0a0a0; line-height: 1.7; margin-bottom: 1.5rem;">
            Known as "The Jailbreak Chef," specializing in LLM jailbreaking and adversarial AI. Creator of the AATMF and P.R.O.M.P.T frameworks for systematic AI security analysis.
          </p>

          <div class="flex flex-wrap gap-3">
            <a href="/about/" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-all hover:scale-105" style="font-family: 'Inter', sans-serif; font-size: 0.875rem; font-weight: 500; background: linear-gradient(135deg, rgba(220, 38, 38, 0.15), rgba(220, 38, 38, 0.05)); color: #ff6b6b; border: 1px solid rgba(220, 38, 38, 0.3);">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
              </svg>
              About
            </a>
            <a href="https://github.com/SnailSploit" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-all hover:scale-105" style="font-family: 'Inter', sans-serif; font-size: 0.875rem; font-weight: 500; background: rgba(255, 255, 255, 0.03); color: #888888; border: 1px solid rgba(255, 255, 255, 0.08);">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
              </svg>
              GitHub
            </a>
            <a href="https://linkedin.com/in/kaiaizen" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-all hover:scale-105" style="font-family: 'Inter', sans-serif; font-size: 0.875rem; font-weight: 500; background: rgba(255, 255, 255, 0.03); color: #888888; border: 1px solid rgba(255, 255, 255, 0.08);">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              LinkedIn
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Related Research -->
    {allRelatedLinks.length > 0 && (
      <div class="mt-8 p-8 rounded-2xl" style="background: linear-gradient(180deg, rgba(20, 20, 20, 0.8), rgba(15, 15, 15, 0.95)); border: 1px solid rgba(255, 255, 255, 0.06);">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, rgba(220, 38, 38, 0.15), rgba(220, 38, 38, 0.05)); border: 1px solid rgba(220, 38, 38, 0.2);">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: var(--color-accent-red);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
          </div>
          <h3 style="font-family: 'Plus Jakarta Sans', sans-serif; font-size: 1.25rem; font-weight: 700; color: #ffffff;">
            Related Research
          </h3>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          {allRelatedLinks.map(link => (
            <a
              href={link.url}
              class="group relative p-4 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:-translate-y-0.5"
              style="background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.06);"
            >
              <div class="absolute inset-0 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity" style="background: linear-gradient(135deg, rgba(220, 38, 38, 0.08), transparent);"></div>
              <div class="relative flex items-center gap-3">
                {link.type && (
                  <span
                    class="px-3 py-1 text-xs font-semibold rounded-full shrink-0"
                    style="font-family: 'Inter', sans-serif; background: linear-gradient(135deg, rgba(220, 38, 38, 0.12), rgba(220, 38, 38, 0.04)); color: #ff6b6b; border: 1px solid rgba(220, 38, 38, 0.2);"
                  >
                    {link.type}
                  </span>
                )}
                <span class="flex-1 text-sm font-medium group-hover:text-[var(--color-accent-red)] transition-colors" style="font-family: 'Inter', sans-serif; color: #c0c0c0;">
                  {link.title}
                </span>
                <svg class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-all transform translate-x-0 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: var(--color-accent-red);">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </div>
            </a>
          ))}
        </div>
      </div>
    )}
  </article>

  <Footer slot="footer" />
</BaseLayout>

<style is:global>
  /* ============================================
     IMPRESSIVE ARTICLE HEADER
     ============================================ */

  .article-header {
    position: relative;
    padding-bottom: 2rem;
  }

  .title-glow {
    position: absolute;
    top: -50px;
    left: -100px;
    width: 400px;
    height: 200px;
    background: radial-gradient(ellipse, rgba(220, 38, 38, 0.15) 0%, transparent 70%);
    pointer-events: none;
    z-index: -1;
  }

  .article-title {
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: clamp(2.5rem, 6vw, 4rem);
    font-weight: 800;
    line-height: 1.1;
    letter-spacing: -0.03em;
    margin-bottom: 1.5rem;
    position: relative;
  }

  .title-text {
    background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 50%, #ffffff 100%);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: titleShimmer 8s ease-in-out infinite;
    display: inline;
    text-shadow: 0 0 80px rgba(220, 38, 38, 0.3);
  }

  @keyframes titleShimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  .article-meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.75rem;
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    color: #888888;
    margin-bottom: 1.5rem;
  }

  .meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: color 0.2s ease;
  }

  .meta-item:hover {
    color: #aaaaaa;
  }

  .meta-dot {
    width: 4px;
    height: 4px;
    background: var(--color-accent-red);
    border-radius: 50%;
    box-shadow: 0 0 6px rgba(220, 38, 38, 0.5);
  }

  .category-badge {
    text-transform: uppercase;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    padding: 0.25rem 0.75rem;
    background: rgba(220, 38, 38, 0.1);
    border: 1px solid rgba(220, 38, 38, 0.2);
    border-radius: 100px;
    color: var(--color-accent-red);
  }

  .tag-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
  }

  .tag-pill {
    font-family: 'Inter', sans-serif;
    font-size: 0.75rem;
    font-weight: 500;
    padding: 0.4rem 1rem;
    background: linear-gradient(135deg, rgba(220, 38, 38, 0.12), rgba(220, 38, 38, 0.04));
    color: #ff6b6b;
    border: 1px solid rgba(220, 38, 38, 0.25);
    border-radius: 100px;
    transition: all 0.25s ease;
  }

  .tag-pill:hover {
    background: rgba(220, 38, 38, 0.2);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2);
  }

  .hub-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: linear-gradient(135deg, rgba(220, 38, 38, 0.1), rgba(220, 38, 38, 0.02));
    border: 1px solid rgba(220, 38, 38, 0.2);
    border-radius: 12px;
    margin-bottom: 1.5rem;
    transition: all 0.25s ease;
  }

  .hub-link:hover {
    background: rgba(220, 38, 38, 0.15);
    border-color: rgba(220, 38, 38, 0.4);
    transform: translateX(4px);
  }

  .hub-label {
    font-family: 'Inter', sans-serif;
    font-size: 0.875rem;
    color: #888888;
  }

  .hub-anchor {
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-accent-red);
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .hub-anchor:hover {
    color: #ff6b6b;
  }

  .header-divider {
    height: 2px;
    background: linear-gradient(90deg, var(--color-accent-red), rgba(220, 38, 38, 0.3), transparent);
    margin-top: 2rem;
    border-radius: 2px;
    box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
  }

  /* ============================================
     MODERN ARTICLE TYPOGRAPHY
     Optimized for extended reading sessions
     Using :global for slotted content
     ============================================ */

  .prose {
    font-family: 'Source Serif 4', Georgia, serif;
    color: #e0e0e0;
    font-size: 1.2rem;
    line-height: 1.9;
    max-width: 70ch;
    margin: 0 auto;
    font-weight: 400;
    letter-spacing: 0.01em;
    font-optical-sizing: auto;
  }

  /* Drop cap for first paragraph (after any initial heading) */
  .prose > p:first-of-type::first-letter {
    float: left;
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 4rem;
    font-weight: 700;
    line-height: 0.8;
    padding-right: 0.15em;
    padding-top: 0.1em;
    color: var(--color-accent-red);
  }

  /* Headings - Modern sans-serif */
  .prose h2 {
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #ffffff;
    font-size: 2rem;
    font-weight: 700;
    margin-top: 3.5rem;
    margin-bottom: 1.5rem;
    padding-top: 1.5rem;
    letter-spacing: -0.02em;
    position: relative;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
  }

  .prose h2::before {
    content: '';
    position: absolute;
    top: -1px;
    left: 0;
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, var(--color-accent-red), transparent);
    border-radius: 2px;
  }

  /* First h2 shouldn't have top margin */
  .prose h2:first-child,
  .prose > h2:first-of-type {
    margin-top: 0;
    padding-top: 0;
    border-top: none;
  }

  .prose h2:first-child::before,
  .prose > h2:first-of-type::before {
    display: none;
  }

  .prose h3 {
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #f0f0f0;
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    letter-spacing: -0.01em;
  }

  /* First h3 at the top shouldn't have excessive margin */
  .prose > h3:first-child {
    margin-top: 0;
  }

  .prose h4 {
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #e8e8e8;
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
  }

  /* Paragraphs */
  .prose p {
    margin-bottom: 1.75em;
    line-height: 1.9;
    text-align: left;
  }

  /* Links */
  .prose a {
    color: var(--color-accent-red);
    text-decoration: none;
    border-bottom: 1px solid rgba(220, 38, 38, 0.4);
    transition: all 0.2s ease;
  }

  .prose a:hover {
    color: #ff6b6b;
    border-bottom-color: #ff6b6b;
  }

  /* Strong/Bold */
  .prose strong {
    color: #ffffff;
    font-weight: 600;
  }

  /* Emphasis */
  .prose em {
    font-style: italic;
    color: #d0d0d0;
  }

  /* Inline Code */
  .prose code {
    font-family: 'JetBrains Mono', monospace;
    background: rgba(220, 38, 38, 0.08);
    padding: 0.2em 0.5em;
    border-radius: 4px;
    font-size: 0.85em;
    color: #ff6b6b;
    border: 1px solid rgba(220, 38, 38, 0.15);
  }

  /* Code Blocks */
  .prose pre {
    font-family: 'JetBrains Mono', monospace;
    background: #141414;
    padding: 1.5em;
    border-radius: 12px;
    overflow-x: auto;
    border: 1px solid rgba(255, 255, 255, 0.08);
    margin: 2rem 0;
    font-size: 0.875rem;
    line-height: 1.7;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    position: relative;
  }

  .prose pre::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--color-accent-red), #ff6b6b, var(--color-accent-red));
    border-radius: 12px 12px 0 0;
  }

  .prose pre code {
    background: none;
    padding: 0;
    color: #d4d4d4;
    border: none;
    font-size: inherit;
  }

  /* Lists */
  .prose ul,
  .prose ol {
    margin: 1.75em 0;
    padding-left: 0;
  }

  .prose ul {
    list-style: none;
  }

  .prose ul li {
    position: relative;
    padding-left: 1.5em;
    margin-bottom: 0.75em;
    line-height: 1.8;
  }

  .prose ul li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.7em;
    width: 6px;
    height: 6px;
    background: var(--color-accent-red);
    border-radius: 2px;
    transform: rotate(45deg);
  }

  .prose ol {
    list-style: none;
    counter-reset: list-counter;
  }

  .prose ol li {
    position: relative;
    padding-left: 2.25em;
    margin-bottom: 0.75em;
    line-height: 1.8;
    counter-increment: list-counter;
  }

  .prose ol li::before {
    content: counter(list-counter);
    position: absolute;
    left: 0;
    top: 0.15em;
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-weight: 700;
    font-size: 0.85em;
    color: var(--color-accent-red);
    width: 1.6em;
    height: 1.6em;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(220, 38, 38, 0.1);
    border-radius: 50%;
  }

  /* Nested lists */
  .prose ul ul,
  .prose ol ol,
  .prose ul ol,
  .prose ol ul {
    margin: 0.5em 0;
  }

  /* Blockquotes */
  .prose blockquote {
    position: relative;
    border: none;
    border-left: 4px solid var(--color-accent-red);
    padding: 1.5rem 2rem;
    margin: 2rem 0;
    background: rgba(220, 38, 38, 0.05);
    border-radius: 0 12px 12px 0;
    font-style: italic;
    font-size: 1.1rem;
    color: #c0c0c0;
  }

  .prose blockquote::before {
    content: '"';
    position: absolute;
    top: -15px;
    left: 15px;
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 4rem;
    font-weight: 800;
    color: var(--color-accent-red);
    opacity: 0.25;
    line-height: 1;
  }

  .prose blockquote p {
    margin-bottom: 0.5em;
  }

  .prose blockquote p:last-child {
    margin-bottom: 0;
  }

  /* Images */
  .prose img {
    max-width: 100%;
    height: auto;
    border-radius: 12px;
    margin: 2rem 0;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
  }

  /* Horizontal Rules - Elegant divider */
  .prose hr {
    border: none;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--color-accent-red), transparent);
    margin: 3rem auto;
    max-width: 200px;
  }

  /* Tables */
  .prose table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 2rem 0;
    font-family: 'Inter', sans-serif;
    font-size: 0.95rem;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  }

  .prose th {
    background: rgba(220, 38, 38, 0.1);
    padding: 1rem 1.25rem;
    font-weight: 600;
    color: #ffffff;
    text-align: left;
    font-family: 'Plus Jakarta Sans', sans-serif;
    border-bottom: 2px solid var(--color-accent-red);
  }

  .prose td {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    background: rgba(20, 20, 20, 0.5);
  }

  .prose tr:last-child td {
    border-bottom: none;
  }

  .prose tr:hover td {
    background: rgba(220, 38, 38, 0.05);
  }

  /* Section spacing for articles that use sections */
  .prose section {
    margin-bottom: 2rem;
  }

  .prose section h2:first-child {
    margin-top: 0;
  }

  /* Mobile Adjustments */
  @media (max-width: 768px) {
    .prose {
      font-size: 1.1rem;
      line-height: 1.85;
    }

    .prose > p:first-of-type::first-letter {
      font-size: 3rem;
    }

    .prose h2 {
      font-size: 1.5rem;
      margin-top: 2.5rem;
    }

    .prose h3 {
      font-size: 1.25rem;
      margin-top: 2rem;
    }

    .prose blockquote {
      padding: 1.25rem 1.5rem;
      margin: 1.5rem 0;
    }

    .prose blockquote::before {
      font-size: 2.5rem;
      top: -10px;
      left: 10px;
    }

    .prose pre {
      padding: 1em;
      font-size: 0.8rem;
      border-radius: 8px;
      margin: 1.5rem 0;
    }

    .prose ul li,
    .prose ol li {
      padding-left: 1.25em;
    }

    .prose ol li {
      padding-left: 2em;
    }
  }
</style>
